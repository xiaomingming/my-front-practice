<!DOCTYPE HTML>
<html>
    <head>
    <meta charset="utf-8">
    <title>carousel</title>
    <style type="text/css">
    * { margin:0; padding: 0; }
    body { font:12px/1.5 arial; }
    ul { list-style: none; }
    .carousel { position: relative; width: 960px; height: 480px; border: 2px solid orange; margin: 0 auto; }
    .carousel .play { position: absolute; right: 120px; bottom: 23px; z-index: 2; }
    .carousel .play a { padding: 4px 8px; margin-right: 6px; text-decoration: none; border: 1px solid orange; border-radius: 3px; }
    .carousel .play a.current { background: orange; color: #fff; }
    .carousel .pagination { position: absolute;  right: 10px; bottom: 20px; z-index: 2; }
    .carousel .pagination a { display: inline-block; padding: 0 10px; height: 24px; border: 1px solid orange; border-radius: 4px; background: #eee; color: #999; text-decoration: none; line-height: 24px; }
    .carousel .pagination a:hover { text-decoration: none; }
    .carousel .pic { width: 960px; }
    .carousel .pic ul { font-size: 30px; height: 480px; overflow: hidden; *zoom:1; }
    .carousel .pic ul li {  float: left; width: 960px; text-align: center; overflow: hidden; }
    .carousel .pic ul li a { display: block; height: 480px; line-height: 480px; background: #efefef; }
    </style>
    </head>
    <body>
        <h1>a simple carousel</h1>
        <div id="carousel" class="carousel">
            <div class="pic">
                <ul>
                    <li><a href="#"><img src="../images/1.jpg" alt=""></a></li>
                    <li><a href="#"><img src="../images/2.jpg" alt=""></a></li>
                    <li><a href="#"><img src="../images/3.jpg" alt=""></a></li>
                    <li><a href="#"><img src="../images/4.jpg" alt=""></a></li>
                    <li><a href="#"><img src="../images/5.jpg" alt=""></a></li>
                </ul>
                <div class="pagination">
                    <a href="#" class="prev">prev</a>
                    <a href="#" class="next">next</a>
                </div>
                <div class="play">
                    <!-- 此处需要动态插入一段数字代码 -->
                </div>
            </div>
        </div>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js "></script>
        <script type="text/javascript">
        /*
        * @name EasyCarousel
        * @class 一个简单的图片轮播插件，支持渐隐，向上，向左滑动
        * @param {}
        * @author: leweiming
        * @gmail: xmlovecss@gmail.com
        * @example
        * new EasyCarousel({ container:$('#carousel'),interval:3000,hideDuration:300,showDuration:800})
        */
            var EasyCarousel=function(options){
                this.containner=options.containner;
                var containner=this.containner;
                this.pagination=containner.find('.pagination');
                this.play=containner.find('.play');
                this.picList=containner.find('.pic ul li');
                this.prev=this.pagination.find('.prev');
                this.next=this.pagination.find('.next');
                this.pageNum=0;

                this.direction={
                    left:'left',
                    right:'right',
                    st:'switch'
                };
                var defaults={
                    isAuto:true,
                    interval:3000,
                    hideDuration:300,
                    showDruation:800
                };
                var settings=$.extend({}, defaults,options);

                this.isAuto=settings.isAuto;
                this.interval=settings.interval;
                this.hideDuration=settings.hideDuration;
                this.showDruation=settings.showDruation;

                this.animatingFlag=true;
                this.timer=null;

                this.initialize();
            };
            EasyCarousel.prototype={
                contstructor:EasyCarousel,
                initialize:function(){
                    var _this=this;
                    this.createPlayNumberHtml();
                    this.prev.on('click',function(e){
                        e.preventDefault();
                        _this.animatingFlag&&_this.autoPlay(_this.pageNum,_this.direction.right);
                    });
                    this.next.on('click',function(e){
                        e.preventDefault();
                        _this.animatingFlag&&_this.autoPlay(_this.pageNum,_this.direction.left);
                    });
                    // play number
                    this.play.on('click','a',function(e){
                        e.preventDefault();
                        _this.animatingFlag&&_this.autoPlay(Number($(this).attr('data-number')),_this.direction.st);
                    });
                    if(!this.isAuto){
                        return false;
                    }
                    this.containner.on('mouseover',function(){
                        _this.stopPlay();
                    });
                    this.containner.on('mouseout',function(){
                        _this.timer=setInterval(function(){
                            _this.autoPlay(_this.pageNum,'left');
                        },_this.interval);
                    });
                    this.containner.trigger('mouseleave');
                },
                createPlayNumberHtml:function(){
                    var _this=this;
                    return (function(picListLength){
                        var playHtml='';
                        for(var i=0; i<picListLength; i++){
                            playHtml+='<a href="#" data-number="'+i+'">'+(i+1)+'</a>';
                        }
                        _this.play.html(playHtml);
                        _this.play.find('a').eq(0).addClass('current');
                    })(_this.picList.length);
                },
                showPic:function(pageNumber){
                    var _this=this;
                    return this.picList.eq(pageNumber).stop(true,true).fadeIn(_this.showDruation).promise();
                },
                hidePic:function(pageNumber){
                    var _this=this;
                    return this.picList.eq(pageNumber).siblings().stop(true,true).fadeOut(_this.hideDuration).promise();
                },
                carousel:function(pageNumber){
                    var _this=this;
                    this.animatingFlag=false;
                    return this.hidePic(pageNumber).then(_this.showPic(pageNumber)).then(function(){_this.animatingFlag=true;}).then(_this.playNumber(pageNumber));
                },
                playNumber:function(pageNumber){
                    return this.play.find('a').eq(pageNumber).addClass('current').siblings('').removeClass('current');
                },
                getPlayNumber:function(page,direction){
                    if(direction==='left'){
                        this.pageNum=page===(this.picList.length-1)?0:this.pageNum+1;
                    }else if(direction==='right'){
                        this.pageNum=page===0?this.picList.length-1:this.pageNum-1;
                    }else if(direction==='switch'){
                        this.pageNum=page;
                    }
                    return this.pageNum;
                },
                autoPlay:function(pageNum,direction){
                    var pageNumber=this.getPlayNumber(pageNum,direction);
                    return this.carousel(pageNumber);
                },
                stopPlay:function(){
                    var _this=this;
                    clearInterval(_this.timer);
                    return this.timer=null;
                }
            };
            $(function(){
                new EasyCarousel({
                    containner:$('#carousel'),
                    interval:3000,
                    showDruation:800,
                    hideDuration:300

                });
            });
        </script>
    </body>
</html>
